<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë™ë£Œë“¤ - ì„¤ì •</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #fff;
      min-height: 100vh;
      padding: 20px;
    }
    
    h1 {
      font-size: 24px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .section {
      background: rgba(255,255,255,0.1);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .section h2 {
      font-size: 16px;
      color: #a0a0a0;
      margin-bottom: 15px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    label {
      display: block;
      margin-bottom: 5px;
      font-size: 14px;
      color: #ccc;
    }
    
    input[type="text"], input[type="password"] {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 8px;
      background: rgba(0,0,0,0.3);
      color: #fff;
      font-size: 14px;
    }
    
    input:focus {
      outline: none;
      border-color: #4a9eff;
    }
    
    .mode-selector {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .mode-btn {
      flex: 1;
      padding: 15px;
      border: 2px solid rgba(255,255,255,0.2);
      border-radius: 10px;
      background: rgba(0,0,0,0.2);
      color: #fff;
      cursor: pointer;
      text-align: center;
      transition: all 0.2s;
    }
    
    .mode-btn:hover {
      border-color: rgba(255,255,255,0.4);
    }
    
    .mode-btn.active {
      border-color: #4a9eff;
      background: rgba(74, 158, 255, 0.2);
    }
    
    .mode-btn .icon {
      font-size: 24px;
      margin-bottom: 5px;
    }
    
    .mode-btn .label {
      font-size: 14px;
      font-weight: bold;
    }
    
    .mode-btn .desc {
      font-size: 12px;
      color: #888;
      margin-top: 5px;
    }
    
    .employee-card {
      background: rgba(0,0,0,0.2);
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 10px;
    }
    
    .employee-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    
    .employee-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #333;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }
    
    .employee-info h3 {
      font-size: 14px;
      margin-bottom: 2px;
    }
    
    .employee-info .role {
      font-size: 12px;
      color: #888;
    }
    
    .connection-status {
      margin-left: auto;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 12px;
    }
    
    .connection-status.api {
      background: rgba(39, 174, 96, 0.3);
      color: #2ecc71;
    }
    
    .connection-status.clawdbot {
      background: rgba(74, 158, 255, 0.3);
      color: #4a9eff;
    }
    
    .connection-status.none {
      background: rgba(255,255,255,0.1);
      color: #888;
    }
    
    .clawdbot-config {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid rgba(255,255,255,0.1);
    }
    
    .clawdbot-config.hidden {
      display: none;
    }
    
    .input-row {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
    }
    
    .input-row input {
      flex: 1;
    }
    
    button {
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .btn-primary {
      background: #4a9eff;
      color: #fff;
    }
    
    .btn-primary:hover {
      background: #3a8eef;
    }
    
    .btn-secondary {
      background: rgba(255,255,255,0.1);
      color: #fff;
    }
    
    .btn-secondary:hover {
      background: rgba(255,255,255,0.2);
    }
    
    .btn-success {
      background: #27ae60;
      color: #fff;
    }
    
    .btn-danger {
      background: #e74c3c;
      color: #fff;
    }
    
    .test-result {
      margin-top: 10px;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 13px;
    }
    
    .test-result.success {
      background: rgba(39, 174, 96, 0.2);
      color: #2ecc71;
    }
    
    .test-result.error {
      background: rgba(231, 76, 60, 0.2);
      color: #e74c3c;
    }
    
    .toggle-btn {
      background: none;
      border: 1px solid rgba(255,255,255,0.3);
      color: #fff;
      padding: 5px 10px;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <h1>âš™ï¸ ë™ë£Œë“¤ ì„¤ì •</h1>
  
  <div class="section">
    <h2>ì—°ê²° ëª¨ë“œ</h2>
    <div class="mode-selector">
      <div class="mode-btn" data-mode="api" onclick="setMode('api')">
        <div class="icon">ğŸ”Œ</div>
        <div class="label">API ëª¨ë“œ</div>
        <div class="desc">Claude API ì§ì ‘ í˜¸ì¶œ</div>
      </div>
      <div class="mode-btn" data-mode="clawdbot" onclick="setMode('clawdbot')">
        <div class="icon">ğŸ¤–</div>
        <div class="label">Clawdbot ëª¨ë“œ</div>
        <div class="desc">Clawdbot Gateway ì—°ê²°</div>
      </div>
    </div>
    
    <div id="api-config">
      <div class="form-group">
        <label>Anthropic API Key</label>
        <div class="input-row">
          <input type="password" id="api-key" placeholder="sk-ant-...">
          <button class="btn-primary" onclick="saveApiKey()">ì €ì¥</button>
        </div>
      </div>
    </div>
  </div>
  
  <div class="section">
    <h2>ìºë¦­í„°ë³„ Clawdbot ì„¤ì •</h2>
    <p style="color:#888; font-size:13px; margin-bottom:15px;">
      ê° ìºë¦­í„°ì— ê°œë³„ Clawdbotì„ ì—°ê²°í•˜ë©´ í•´ë‹¹ ìºë¦­í„°ëŠ” Clawdbot ëª¨ë“œë¡œ ì‘ë™í•©ë‹ˆë‹¤.
    </p>
    <div id="employees-list"></div>
  </div>
  
  <script>
    let config = {};
    
    async function loadConfig() {
      config = await window.api.getConfig();
      renderConfig();
    }
    
    function renderConfig() {
      // ëª¨ë“œ ë²„íŠ¼ í™œì„±í™”
      document.querySelectorAll('.mode-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.mode === config.connectionMode);
      });
      
      // ì§ì› ëª©ë¡ ë Œë”ë§
      const container = document.getElementById('employees-list');
      container.innerHTML = '';
      
      const avatars = { kim: 'ğŸ‘¨â€âš–ï¸', park: 'ğŸ‘©â€ğŸ’¼', oh: 'ğŸ‘·', lee: 'ğŸ‘©â€ğŸ¨', jung: 'ğŸ‘¨â€ğŸ’¼' };
      
      Object.entries(config.employees).forEach(([id, emp]) => {
        const hasClawdbot = emp.clawdbot && emp.clawdbot.url;
        const card = document.createElement('div');
        card.className = 'employee-card';
        card.innerHTML = `
          <div class="employee-header">
            <div class="employee-avatar">${avatars[id] || 'ğŸ‘¤'}</div>
            <div class="employee-info">
              <h3>${emp.name}</h3>
              <div class="role">${id}</div>
            </div>
            <div class="connection-status ${hasClawdbot ? 'clawdbot' : 'api'}">
              ${hasClawdbot ? 'ğŸ¤– Clawdbot' : 'ğŸ”Œ API'}
            </div>
          </div>
          <div class="clawdbot-config" id="config-${id}">
            <div class="input-row">
              <input type="text" id="url-${id}" placeholder="http://localhost:3001" 
                value="${emp.clawdbot?.url || ''}">
              <input type="text" id="token-${id}" placeholder="í† í° (ì„ íƒ)" 
                value="${emp.clawdbot?.token || ''}">
            </div>
            <div class="input-row">
              <input type="text" id="session-${id}" placeholder="ì„¸ì…˜í‚¤ (ê¸°ë³¸: employee-${id})"
                value="${emp.clawdbot?.sessionKey || ''}">
              <button class="btn-secondary" onclick="testConnection('${id}')">í…ŒìŠ¤íŠ¸</button>
              <button class="btn-primary" onclick="saveClawdbot('${id}')">ì €ì¥</button>
              ${hasClawdbot ? `<button class="btn-danger" onclick="removeClawdbot('${id}')">ì œê±°</button>` : ''}
            </div>
            <div id="test-result-${id}"></div>
          </div>
        `;
        container.appendChild(card);
      });
    }
    
    async function setMode(mode) {
      await window.api.setConnectionMode(mode);
      config.connectionMode = mode;
      renderConfig();
    }
    
    async function saveApiKey() {
      const key = document.getElementById('api-key').value.trim();
      if (key) {
        const result = await window.api.setApiKey(key);
        alert(result.success ? 'API í‚¤ ì €ì¥ë¨!' : 'ì €ì¥ ì‹¤íŒ¨');
      }
    }
    
    async function testConnection(id) {
      const url = document.getElementById(`url-${id}`).value.trim();
      const token = document.getElementById(`token-${id}`).value.trim();
      const resultDiv = document.getElementById(`test-result-${id}`);
      
      if (!url) {
        resultDiv.className = 'test-result error';
        resultDiv.textContent = 'URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”';
        return;
      }
      
      resultDiv.className = 'test-result';
      resultDiv.textContent = 'ì—°ê²° í…ŒìŠ¤íŠ¸ ì¤‘...';
      
      const result = await window.api.testClawdbot(url, token);
      resultDiv.className = `test-result ${result.success ? 'success' : 'error'}`;
      resultDiv.textContent = result.message;
    }
    
    async function saveClawdbot(id) {
      const url = document.getElementById(`url-${id}`).value.trim();
      const token = document.getElementById(`token-${id}`).value.trim();
      const sessionKey = document.getElementById(`session-${id}`).value.trim();
      
      if (!url) {
        alert('URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
        return;
      }
      
      await window.api.setEmployeeClawdbot(id, {
        url,
        token: token || null,
        sessionKey: sessionKey || `employee-${id}`
      });
      
      alert('ì €ì¥ë¨!');
      loadConfig();
    }
    
    async function removeClawdbot(id) {
      if (confirm('Clawdbot ì—°ê²°ì„ ì œê±°í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        await window.api.setEmployeeClawdbot(id, null);
        loadConfig();
      }
    }
    
    // ì´ˆê¸° ë¡œë“œ
    loadConfig();
  </script>
</body>
</html>
